# СПЕЦИФИКАЦИЯ СИСТЕМЫ ПОДПИСИ И ПРОВЕРКИ ЦЕЛОСТНОСТИ ФАЙЛОВ

**Версия:** 1.0  
**Дата:** 2025  
**Статус:** Утверждено

---

## СОДЕРЖАНИЕ

1. [Общие сведения](#1-общие-сведения)
2. [Назначение и цели создания системы](#2-назначение-и-цели-создания-системы)
3. [Характеристики объектов автоматизации](#3-характеристики-объектов-автоматизации)
4. [Требования к системе](#4-требования-к-системе)
5. [Состав системы](#5-состав-системы)
6. [Описание функций системы](#6-описание-функций-системы)
7. [Требования к программной документации](#7-требования-к-программной-документации)
8. [Стадии и этапы разработки](#8-стадии-и-этапы-разработки)
9. [Порядок контроля и приемки](#9-порядок-контроля-и-приемки)
10. [Приложения](#10-приложения)

---

## 1. Общие сведения

### 1.1. Назначение документа
Настоящий документ содержит спецификацию системы для подписи и проверки целостности файлов с использованием асимметричной криптографии. Документ разработан в соответствии с требованиями ГОСТ 34.201-89 "Информационные технологии. Комплекс стандартов на автоматизированные системы. Виды, комплектность и обозначение документов при создании автоматизированных систем" и предназначен для разработчиков, системных администраторов и пользователей системы.

### 1.2. Область применения
Система предназначена для обеспечения целостности файлов посредством создания цифровых подписей и их последующей верификации. Применяется в сценариях, требующих гарантии неизменности данных с момента подписания.

### 1.3. Термины и определения
- **Цифровая подпись** — криптографический механизм, обеспечивающий аутентификацию и целостность данных
- **Асимметричная криптография** — криптографическая система, использующая пару ключей (открытый и закрытый)
- **Хеш-функция** — односторонняя функция, преобразующая данные произвольной длины в фиксированную строку
- **PEM** — формат кодирования криптографических ключей в текстовом виде (Privacy-Enhanced Mail)
- **RSA** — алгоритм асимметричного шифрования, названный по именам создателей (Rivest, Shamir, Adleman)
- **ECDSA** — алгоритм цифровой подписи на основе эллиптических кривых (Elliptic Curve Digital Signature Algorithm)

## 2. Назначение и цели создания системы

### 2.1. Назначение
Система обеспечивает:
- Генерацию криптографических ключевых пар (RSA и ECDSA)
- Создание цифровых подписей для файлов
- Проверку целостности файлов путем верификации подписей

### 2.2. Цели создания
- Предоставление инструмента командной строки для работы с цифровыми подписями
- Обеспечение криптографической защиты целостности данных
- Поддержка современных алгоритмов асимметричного шифрования
- Простота использования и интеграции

## 3. Характеристики объектов автоматизации

### 3.1. Объекты автоматизации
Объектами автоматизации являются файлы произвольного типа и размера, для которых требуется обеспечить целостность.

### 3.2. Характеристики обрабатываемых данных
- **Тип данных**: файлы произвольного формата
- **Размер**: не ограничен (обработка потоковая)
- **Формат ключей**: PEM (текстовый формат)
- **Формат подписей**: Base64-кодированные бинарные данные

## 4. Требования к системе

### 4.1. Требования к функциональным характеристикам

#### 4.1.1. Генерация ключевых пар
Система должна поддерживать генерацию ключевых пар для следующих алгоритмов:
- **RSA**: размеры ключей 2048, 3072, 4096 бит (по умолчанию 2048)
- **ECDSA**: кривые P-256, P-384, P-521 (по умолчанию P-256)

Ключи должны сохраняться в формате PEM:
- Закрытый ключ: `RSA PRIVATE KEY` или `EC PRIVATE KEY`
- Открытый ключ: `PUBLIC KEY` (PKIX)

#### 4.1.2. Создание цифровой подписи
Процесс подписания файла включает:
1. Вычисление хеш-суммы SHA-256 содержимого файла
2. Подпись хеш-суммы закрытым ключом (RSA PKCS#1 v1.5 или ECDSA ASN.1)
3. Кодирование подписи в Base64
4. Сохранение подписи в файл

#### 4.1.3. Проверка цифровой подписи
Процесс верификации включает:
1. Вычисление хеш-суммы SHA-256 проверяемого файла
2. Декодирование подписи из Base64
3. Проверка подписи открытым ключом
4. Вывод результата верификации

### 4.2. Требования к надежности
- Обработка ошибок на всех этапах работы
- Валидация входных данных
- Защита закрытых ключей (права доступа 0600 на Unix-системах)
- Использование криптографически стойких генераторов случайных чисел

### 4.3. Требования к составу и параметрам технических средств
- **Операционная система**: Windows, Linux, macOS
- **Go версия**: 1.25.4 или выше
- **Зависимости**: только стандартная библиотека Go

### 4.4. Требования к информационной совместимости
- Формат ключей: PEM (совместим с OpenSSL, GnuPG)
- Формат подписей: Base64 (текстовый, удобен для передачи)

## 5. Состав системы

### 5.1. Структура системы
Система состоит из следующих компонентов:

```
security-signature/
├── cmd/
│   └── main.go              # Точка входа, CLI интерфейс
├── pkg/
│   └── signature/
│       ├── key.go           # Генерация ключевых пар
│       └── crypto.go        # Криптографические операции
├── tests/
│   └── signature_test.go    # Автоматические тесты
└── docs/                    # Документация
```

### 5.2. Описание компонентов

#### 5.2.1. CLI интерфейс (cmd/main.go)
Обеспечивает:
- Парсинг аргументов командной строки
- Маршрутизацию команд (keygen, sign, verify)
- Обработку ошибок и вывод сообщений

#### 5.2.2. Модуль генерации ключей (pkg/signature/key.go)
Функции:
- `GenerateKeyPair()` — генерация пары ключей
- `generateRSAKeyPair()` — генерация RSA ключей
- `generateECDSAKeyPair()` — генерация ECDSA ключей
- `selectCurve()` — выбор эллиптической кривой

#### 5.2.3. Криптографический модуль (pkg/signature/crypto.go)
Функции:
- `HashFileSHA256()` — вычисление SHA-256 хеша файла
- `SignDigest()` — подпись хеш-суммы
- `VerifyDigest()` — проверка подписи
- `LoadPrivateKeyPEM()` — загрузка закрытого ключа
- `LoadPublicKeyPEM()` — загрузка открытого ключа
- `EncodeSignatureBase64()` / `DecodeSignatureBase64()` — кодирование подписей

## 6. Описание функций системы

### 6.1. Команда keygen
**Назначение**: Генерация пары криптографических ключей

**Параметры**:
- `-algo` — алгоритм (rsa/ecdsa), по умолчанию: rsa
- `-bits` — размер RSA ключа в битах, по умолчанию: 2048
- `-curve` — кривая ECDSA (p256/p384/p521), по умолчанию: p256
- `-out-priv` — путь к файлу закрытого ключа, по умолчанию: private_key.pem
- `-out-pub` — путь к файлу открытого ключа, по умолчанию: public_key.pem

**Выходные данные**: Два PEM файла с ключами

### 6.2. Команда sign
**Назначение**: Создание цифровой подписи файла

**Параметры**:
- `-key` — путь к файлу закрытого ключа, по умолчанию: private_key.pem
- `-in` — путь к подписываемому файлу (обязательный)
- `-out` — путь к файлу подписи, по умолчанию: signature.sig

**Выходные данные**: Файл с Base64-кодированной подписью

### 6.3. Команда verify
**Назначение**: Проверка цифровой подписи файла

**Параметры**:
- `-key` — путь к файлу открытого ключа, по умолчанию: public_key.pem
- `-in` — путь к проверяемому файлу (обязательный)
- `-sig` — путь к файлу подписи, по умолчанию: signature.sig

**Выходные данные**: Сообщение о результате верификации

## 7. Требования к программной документации

### 7.1. Состав документации
- README.md — краткое описание и инструкции по установке
- Руководство оператора
- Руководство системного программиста
- Руководство программиста
- Техническое задание
- Спецификация (настоящий документ)

### 7.2. Требования к оформлению
- Формат: Markdown
- Кодировка: UTF-8
- Язык: русский

## 8. Стадии и этапы разработки

### 8.1. Стадия разработки
- Проектирование архитектуры
- Реализация криптографических функций
- Реализация CLI интерфейса
- Написание тестов
- Создание документации

### 8.2. Стадия внедрения
- Сборка бинарных файлов
- Тестирование на целевых платформах
- Публикация в репозитории

## 9. Порядок контроля и приемки

### 9.1. Виды испытаний
- Модульное тестирование (unit tests)
- Интеграционное тестирование (CLI workflow)
- Тестирование на различных платформах

### 9.2. Критерии приемки
- Все автоматические тесты проходят успешно
- Документация полная и актуальная
- Система работает на всех заявленных платформах

## 10. Приложения

### 10.1. Используемые стандарты и протоколы
- RFC 3447 — PKCS #1: RSA Cryptography Specifications
- RFC 5480 — Elliptic Curve Cryptography Subject Public Key Info
- RFC 7468 — Textual Encodings of PKIX, PKCS, and CMS Structures (PEM)
- FIPS 186-4 — Digital Signature Standard

### 10.2. Ссылки на используемые библиотеки
- Go standard library: `crypto/rsa`, `crypto/ecdsa`, `crypto/sha256`, `crypto/x509`, `encoding/pem`, `encoding/base64`

---

## СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ

1. ГОСТ 34.201-89. Информационные технологии. Комплекс стандартов на автоматизированные системы. Виды, комплектность и обозначение документов при создании автоматизированных систем. — М.: Стандартинформ, 1989.

2. ГОСТ 34.602-2019. Информационные технологии. Комплекс стандартов на автоматизированные системы. Техническое задание на создание автоматизированной системы. — М.: Стандартинформ, 2019.

3. RFC 3447. PKCS #1: RSA Cryptography Specifications Version 2.1. — 2003.

4. RFC 5480. Elliptic Curve Cryptography Subject Public Key Info. — 2009.

5. RFC 7468. Textual Encodings of PKIX, PKCS, and CMS Structures. — 2015.

6. FIPS 186-4. Digital Signature Standard (DSS). — 2013.

7. The Go Programming Language Specification. Version 1.25. — https://go.dev/ref/spec

---

**Разработчик:** _________________  
**Дата:** _________________  
**Утверждено:** _________________

